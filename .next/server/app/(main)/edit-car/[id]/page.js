(()=>{var e={};e.id=831,e.ids=[831],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1361:(e,r,n)=>{"use strict";n.d(r,{A:()=>a});let a=(0,n(8962).A)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},1860:(e,r,n)=>{"use strict";n.d(r,{A:()=>a});let a=(0,n(8962).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3125:(e,r,n)=>{"use strict";n.d(r,{A:()=>a});let a=(0,n(8962).A)("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]])},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4392:(e,r,n)=>{Promise.resolve().then(n.bind(n,6340))},6340:(e,r,n)=>{"use strict";n.r(r),n.d(r,{default:()=>u});var a=n(687),s=n(3210),t=n(6189),i=n(3125);let l=(0,n(8962).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var o=n(1860),d=n(1361),c=n(7353);function u(){let e=(0,t.useParams)().id,r=(0,t.useRouter)(),[n,u]=(0,s.useState)(!1),[m,p]=(0,s.useState)(!0),[x,h]=(0,s.useState)({name:"",make:"",model:"",year:new Date().getFullYear(),price:0,mileage:0,condition:"Used",transmission:"Automatic",engineSize:"",fuelType:"Petrol",bodyType:"Sedan",color:"",status:"Available"}),[g,f]=(0,s.useState)(!1),[b,y]=(0,s.useState)(null),[v,j]=(0,s.useState)([]),[N,k]=(0,s.useState)([]),w=e=>{let{name:r,value:n}=e.target;h(e=>({...e,[r]:"price"===r||"mileage"===r||"year"===r?Number(n):n}))},C=e=>{let r=v[e];r.isNew&&r.file&&URL.revokeObjectURL(r.url),r.isNew||k(e=>[...e,r.url]),j(r=>r.filter((r,n)=>n!==e))},P=async n=>{if(n.preventDefault(),0===v.length)return void y("Please add at least one image of the car");if(!x.name.trim()||!x.make.trim()||!x.model.trim()||x.price<=0||!x.engineSize.trim()||!x.color.trim())return void y("Please fill in all required fields with valid values");u(!0),y(null);try{let n=new FormData;Object.entries(x).forEach(([e,r])=>{n.append(e,r.toString())}),v.filter(e=>e.isNew&&e.file).forEach(e=>{e.file&&n.append("images",e.file)}),N.length>0&&n.append("imagesToDelete",JSON.stringify(N)),await c.j.updateCar(e,n),r.push("/inventory")}catch(e){console.error("Error updating car:",e),y(e instanceof Error?e.message:"Failed to update car listing")}finally{u(!1)}};return m?(0,a.jsx)("div",{className:"p-6 max-w-4xl mx-auto text-center",children:(0,a.jsxs)("div",{className:"flex items-center justify-center mb-4",children:[(0,a.jsx)(i.A,{className:"w-8 h-8 animate-spin mr-2"}),(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Loading Car Details..."})]})}):g?(0,a.jsxs)("div",{className:"p-6 max-w-4xl mx-auto text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Car Not Found"}),(0,a.jsx)("p",{className:"mb-6",children:"The car listing you're looking for doesn't exist or has been removed."}),(0,a.jsx)("button",{onClick:()=>r.push("/inventory"),className:"bg-primary hover:bg-primary-hover text-black px-4 py-2 rounded-lg transition-colors",children:"Back to Inventory"})]}):(0,a.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)("button",{onClick:()=>r.push("/inventory"),className:"mr-4 p-1 hover:bg-gray-100 rounded-full",children:(0,a.jsx)(l,{className:"w-5 h-5"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Edit Car Listing"})]}),b&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-red-50 text-red-700 rounded-lg",children:b}),(0,a.jsxs)("form",{onSubmit:P,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Car Name"}),(0,a.jsx)("input",{type:"text",name:"name",value:x.name,onChange:w,placeholder:"e.g. Toyota Land Cruiser V8",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Make"}),(0,a.jsx)("input",{type:"text",name:"make",value:x.make,onChange:w,placeholder:"e.g. Toyota",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Model"}),(0,a.jsx)("input",{type:"text",name:"model",value:x.model,onChange:w,placeholder:"e.g. Land Cruiser",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Year"}),(0,a.jsx)("select",{name:"year",value:x.year,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0,children:Array.from({length:30},(e,r)=>new Date().getFullYear()-r).map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Price (KSh)"}),(0,a.jsx)("input",{type:"number",name:"price",value:x.price,onChange:w,placeholder:"e.g. 4500000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0,min:"0"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Mileage (km)"}),(0,a.jsx)("input",{type:"number",name:"mileage",value:x.mileage,onChange:w,placeholder:"e.g. 45000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0,min:"0"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Condition"}),(0,a.jsxs)("select",{name:"condition",value:x.condition,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0,children:[(0,a.jsx)("option",{value:"New",children:"New"}),(0,a.jsx)("option",{value:"Used",children:"Used"}),(0,a.jsx)("option",{value:"Certified Pre-Owned",children:"Certified Pre-Owned"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Transmission"}),(0,a.jsxs)("select",{name:"transmission",value:x.transmission,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0,children:[(0,a.jsx)("option",{value:"Automatic",children:"Automatic"}),(0,a.jsx)("option",{value:"Manual",children:"Manual"}),(0,a.jsx)("option",{value:"CVT",children:"CVT"}),(0,a.jsx)("option",{value:"Semi-Automatic",children:"Semi-Automatic"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Engine Size"}),(0,a.jsx)("input",{type:"text",name:"engineSize",value:x.engineSize,onChange:w,placeholder:"e.g. 2.0L",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Fuel Type"}),(0,a.jsxs)("select",{name:"fuelType",value:x.fuelType,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0,children:[(0,a.jsx)("option",{value:"Petrol",children:"Petrol"}),(0,a.jsx)("option",{value:"Diesel",children:"Diesel"}),(0,a.jsx)("option",{value:"Electric",children:"Electric"}),(0,a.jsx)("option",{value:"Hybrid",children:"Hybrid"}),(0,a.jsx)("option",{value:"CNG",children:"CNG"}),(0,a.jsx)("option",{value:"LPG",children:"LPG"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Body Type"}),(0,a.jsxs)("select",{name:"bodyType",value:x.bodyType,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0,children:[(0,a.jsx)("option",{value:"Sedan",children:"Sedan"}),(0,a.jsx)("option",{value:"SUV",children:"SUV"}),(0,a.jsx)("option",{value:"Hatchback",children:"Hatchback"}),(0,a.jsx)("option",{value:"Coupe",children:"Coupe"}),(0,a.jsx)("option",{value:"Convertible",children:"Convertible"}),(0,a.jsx)("option",{value:"Wagon",children:"Wagon"}),(0,a.jsx)("option",{value:"Van",children:"Van"}),(0,a.jsx)("option",{value:"Truck",children:"Truck"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Color"}),(0,a.jsx)("input",{type:"text",name:"color",value:x.color,onChange:w,placeholder:"e.g. Black",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Status"}),(0,a.jsxs)("select",{name:"status",value:x.status,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0,children:[(0,a.jsx)("option",{value:"Available",children:"Available"}),(0,a.jsx)("option",{value:"Sold",children:"Sold"}),(0,a.jsx)("option",{value:"Reserved",children:"Reserved"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Images"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[v.map((e,r)=>(0,a.jsxs)("div",{className:"relative aspect-[4/3] bg-gray-100 rounded-lg overflow-hidden",children:[(0,a.jsx)("img",{src:e.url,alt:`Car preview ${r+1}`,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="https://via.placeholder.com/400x300?text=Image+Not+Available"}}),(0,a.jsx)("button",{type:"button",onClick:()=>C(r),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full hover:bg-red-600",children:(0,a.jsx)(o.A,{className:"w-4 h-4"})})]},r)),(0,a.jsxs)("label",{className:"aspect-[4/3] flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-lg hover:border-primary transition-colors cursor-pointer",children:[(0,a.jsx)(d.A,{className:"w-8 h-8 text-gray-500"}),(0,a.jsx)("span",{className:"mt-2 text-sm text-gray-500",children:"Add Image"}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{if(e.target.files&&e.target.files.length>0){let r=Array.from(e.target.files);if(r.filter(e=>!e.type.startsWith("image/")).length>0)return void y("Please select only image files (JPEG, PNG, etc.)");if(r.filter(e=>e.size>5242880).length>0)return void y("Some images exceed the maximum file size of 5MB");y(null);let n=r.map(e=>({url:URL.createObjectURL(e),file:e,isNew:!0}));j(e=>[...e,...n])}},className:"hidden"})]})]}),(0,a.jsx)("p",{className:"mt-2 text-xs text-gray-500",children:"Upload up to 10 images. Max 5MB per image. Supported formats: JPEG, PNG, GIF."})]}),(0,a.jsxs)("div",{className:"pt-4 flex gap-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>r.push("/inventory"),className:"px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium rounded-lg transition-colors",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:n,className:"flex-1 bg-primary hover:bg-primary-hover text-black font-medium py-3 rounded-lg transition-colors flex items-center justify-center",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.A,{className:"w-5 h-5 mr-2 animate-spin"}),"Saving Changes..."]}):"Save Changes"})]})]})]})}},7544:(e,r,n)=>{Promise.resolve().then(n.bind(n,8664))},8664:(e,r,n)=>{"use strict";n.r(r),n.d(r,{default:()=>a});let a=(0,n(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\carsawa\\\\app\\\\(main)\\\\edit-car\\\\[id]\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\carsawa\\app\\(main)\\edit-car\\[id]\\page.tsx","default")},9056:(e,r,n)=>{"use strict";n.r(r),n.d(r,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var a=n(5239),s=n(8088),t=n(8170),i=n.n(t),l=n(893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);n.d(r,o);let d={children:["",{children:["(main)",{children:["edit-car",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(n.bind(n,8664)),"D:\\carsawa\\app\\(main)\\edit-car\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(n.bind(n,9559)),"D:\\carsawa\\app\\(main)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(n.t.bind(n,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(n.t.bind(n,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(n.t.bind(n,5284,23)),"next/dist/client/components/unauthorized-error"]}]},{layout:[()=>Promise.resolve().then(n.bind(n,8014)),"D:\\carsawa\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(n.t.bind(n,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(n.t.bind(n,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(n.t.bind(n,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["D:\\carsawa\\app\\(main)\\edit-car\\[id]\\page.tsx"],u={require:n,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/(main)/edit-car/[id]/page",pathname:"/edit-car/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var r=require("../../../../webpack-runtime.js");r.C(e);var n=e=>r(r.s=e),a=r.X(0,[259,895,915,526],()=>n(9056));module.exports=a})();