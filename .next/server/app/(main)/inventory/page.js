(()=>{var e={};e.id=112,e.ids=[112],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1860:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8962).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},2532:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(687),a=r(3210),n=r(5814),l=r.n(n),i=r(3125),o=r(8962);let d=(0,o.A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var c=r(4478);let x=(0,o.A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var h=r(1860);let m=(0,o.A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]),p=(0,o.A)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);var u=r(7353),y=r(1108);function g(){let{user:e}=(0,y.A)(),[t,r]=(0,a.useState)([]),[n,o]=(0,a.useState)("all"),[g,v]=(0,a.useState)(!0),[b,f]=(0,a.useState)(null),j=async()=>{try{if(v(!0),f(null),!e?._id)throw Error("User not authenticated");console.log("Fetching inventory for dealer ID:",e._id);let t=await u.j.getMyListings(e._id);Array.isArray(t)?(r(t),console.log("Loaded inventory (array):",t.length,"cars")):t&&t.cars&&Array.isArray(t.cars)?(r(t.cars),console.log("Loaded inventory (object):",t.cars.length,"cars")):(console.error("Unexpected response format:",t),r([]))}catch(e){f("Failed to load inventory. Please try again."),console.error("Error fetching inventory:",e)}finally{v(!1)}},N=async(e,t)=>{try{await u.j.updateCarStatus(e,t),r(r=>r.map(r=>r._id===e?{...r,status:t}:r))}catch(e){f(`Failed to update car status: ${e instanceof Error?e.message:"Unknown error"}`)}},k=async e=>{if(window.confirm("Are you sure you want to delete this listing?"))try{await u.j.deleteCar(e),r(t=>t.filter(t=>t._id!==e))}catch(e){f(`Failed to delete car: ${e instanceof Error?e.message:"Unknown error"}`)}},w="all"===n?t:t.filter(e=>e.status===n),A=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return g?(0,s.jsxs)("div",{className:"p-6 flex flex-col items-center justify-center h-64",children:[(0,s.jsx)(i.A,{className:"w-8 h-8 animate-spin text-primary mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading inventory..."})]}):e?(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"My Inventory"}),(0,s.jsxs)(l(),{href:"/list-car",className:"bg-primary hover:bg-primary-hover text-black px-4 py-2 rounded-lg transition-colors flex items-center gap-2",children:[(0,s.jsx)(c.A,{className:"w-5 h-5"}),"List New Car"]})]}),b&&(0,s.jsxs)("div",{className:"bg-red-50 text-red-700 p-4 rounded-lg mb-6",children:[b,(0,s.jsx)("button",{onClick:j,className:"ml-4 underline hover:text-red-800",children:"Try Again"})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6",children:[(0,s.jsxs)("div",{className:"flex gap-4 mb-4 flex-wrap",children:[(0,s.jsxs)("button",{onClick:()=>o("all"),className:`px-4 py-2 rounded-lg ${"all"===n?"bg-gray-200":"hover:bg-gray-100"}`,children:["All (",t.length,")"]}),(0,s.jsxs)("button",{onClick:()=>o("Available"),className:`px-4 py-2 rounded-lg ${"Available"===n?"bg-gray-200":"hover:bg-gray-100"}`,children:["Available (",t.filter(e=>"Available"===e.status).length,")"]}),(0,s.jsxs)("button",{onClick:()=>o("Sold"),className:`px-4 py-2 rounded-lg ${"Sold"===n?"bg-gray-200":"hover:bg-gray-100"}`,children:["Sold (",t.filter(e=>"Sold"===e.status).length,")"]}),(0,s.jsxs)("button",{onClick:()=>o("Reserved"),className:`px-4 py-2 rounded-lg ${"Reserved"===n?"bg-gray-200":"hover:bg-gray-100"}`,children:["Reserved (",t.filter(e=>"Reserved"===e.status).length,")"]})]}),0===w.length?(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No cars found in this category."}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-3 text-left",children:"Image"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left",children:"Car Details"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left",children:"Price"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left",children:"Status"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left",children:"Listed Date"}),(0,s.jsx)("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-200",children:w.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-4 py-3",children:(0,s.jsx)("div",{className:"w-16 h-12 overflow-hidden rounded",children:(0,s.jsx)("img",{src:e.images&&e.images.length>0?e.images[0]:"/placeholder.png",alt:`${e.make} ${e.model}`,className:"w-full h-full object-cover"})})}),(0,s.jsx)("td",{className:"px-4 py-3",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"font-medium",children:[e.make," ",e.model]}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:[e.year," \xb7 ",e.mileage.toLocaleString()," km \xb7 ",e.condition]})]})}),(0,s.jsxs)("td",{className:"px-4 py-3 font-medium",children:["KSh ",e.price.toLocaleString()]}),(0,s.jsx)("td",{className:"px-4 py-3",children:(0,s.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${"Available"===e.status?"bg-green-100 text-green-800":"Sold"===e.status?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:e.status})}),(0,s.jsx)("td",{className:"px-4 py-3 text-sm text-gray-500",children:A(e.createdAt)}),(0,s.jsx)("td",{className:"px-4 py-3 text-right",children:(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:["Sold"!==e.status&&(0,s.jsx)("button",{onClick:()=>N(e._id,"Sold"),className:"p-1 hover:bg-blue-100 hover:text-blue-800 rounded",title:"Mark as Sold",children:(0,s.jsx)(x,{className:"w-5 h-5"})}),"Reserved"!==e.status&&(0,s.jsx)("button",{onClick:()=>N(e._id,"Reserved"),className:"p-1 hover:bg-yellow-100 hover:text-yellow-800 rounded",title:"Mark as Reserved",children:(0,s.jsx)(h.A,{className:"w-5 h-5"})}),"Available"!==e.status&&(0,s.jsx)("button",{onClick:()=>N(e._id,"Available"),className:"p-1 hover:bg-green-100 hover:text-green-800 rounded",title:"Mark as Available",children:(0,s.jsx)(c.A,{className:"w-5 h-5"})}),(0,s.jsx)(l(),{href:`/edit-car/${e._id}`,className:"p-1 hover:bg-blue-100 hover:text-blue-800 rounded",title:"Edit Listing",children:(0,s.jsx)(m,{className:"w-5 h-5"})}),(0,s.jsx)("button",{onClick:()=>k(e._id),className:"p-1 hover:bg-red-100 hover:text-red-800 rounded",title:"Delete Listing",children:(0,s.jsx)(p,{className:"w-5 h-5"})})]})})]},e._id))})]})})]})]}):(0,s.jsxs)("div",{className:"p-6 flex flex-col items-center justify-center h-64",children:[(0,s.jsx)(d,{className:"w-8 h-8 text-red-500 mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"You must be logged in to view and manage inventory."}),(0,s.jsx)(l(),{href:"/login",className:"bg-primary hover:bg-primary-hover text-black px-4 py-2 rounded-lg transition-colors",children:"Login"})]})}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3125:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8962).A)("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]])},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},6246:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,pages:()=>c,routeModule:()=>h,tree:()=>d});var s=r(5239),a=r(8088),n=r(8170),l=r.n(n),i=r(893),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let d={children:["",{children:["(main)",{children:["inventory",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,8675)),"D:\\carsawa\\app\\(main)\\inventory\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,9559)),"D:\\carsawa\\app\\(main)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,8014)),"D:\\carsawa\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["D:\\carsawa\\app\\(main)\\inventory\\page.tsx"],x={require:r,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(main)/inventory/page",pathname:"/inventory",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},8675:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\carsawa\\\\app\\\\(main)\\\\inventory\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\carsawa\\app\\(main)\\inventory\\page.tsx","default")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9174:(e,t,r)=>{Promise.resolve().then(r.bind(r,8675))},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9854:(e,t,r)=>{Promise.resolve().then(r.bind(r,2532))}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[259,895,915,526],()=>r(6246));module.exports=s})();